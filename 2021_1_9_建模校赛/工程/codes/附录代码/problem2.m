%%
% 
%  PREFORMATTED
% 
%  PREFORMATTED
%  TEXT
% 
%  TEXT
% 
clear all;
%%% ä¸ºå¤§äºç­‰äº?30æ¨¡å‹
%%% ç›®æ ‡å‡½æ•°å¸¦å¸¸æ•°éè¦å†™åœ? ä¼˜åŒ–é‡Œé¢çš„è¯ã€?
%%%  åœ¨ä¸ç­‰å¼çº¦æŸå¤„åŠ å¤šä¸€åˆ? 0 ,åœ¨ç­‰å¼çº¦æŸå¤„ï¼Œçº¦æŸè¿™ä¸ªä¸º 1
%%% problem2 è¯´æ˜ï¼šé?‰å–ä¸»è¦çš„äº”ç§ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä»–è¦æ±‚çš„è¿›è¡Œé€‰æ‹©
food=45;
% [x,fval] =linprog(f,A,b,Aeq,beq,lb);
w1=0.5; %%ä»·é’±æƒé‡,ç¬¬ä¸€é¢˜ä»·é’±å†³å®?
w2=1-w1;
S=30;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
% f1_sum=xlsread('æ•°æ®.xlsx','sheet1','AB2:AB46')';  %%æœ?å°èŠ±è´?
Q=xlsread('å¯é£Ÿç”?.xlsx','sheet1','A1:A45')';%%å¯ä½¿ç”¨éƒ¨åˆ?45ä¸?
B=xlsread('æ•°æ®æ±‡æ??.xlsx','sheet1','B2:X46');%%ç¬¬iç§é£Ÿç‰©ä¸­ç¬¬jä¸ªè¥å…»å«é‡ï¼›45*23
N=xlsread('å‚è?ƒæ‘„å…¥é‡.xlsx','sheet1','B15:X15');%%ç¬¬jç§è¥å…»å«é‡çš„éœ?æ±‚é‡23
P=xlsread('æ•°æ®æ±‡æ??.xlsx','sheet1','Z2:Z46')';%%æ¯?100gä¸ªé£Ÿç‰©çš„ä»·é’±45ä¸?
L=xlsread('å‚è?ƒæ‘„å…¥é‡.xlsx','sheet1','B2:B10')';%%æ¯?9ç§é£Ÿç‰©ç±»åˆ«çš„æœ?å°æ‘„å…¥é‡
R=xlsread('å‚è?ƒæ‘„å…¥é‡.xlsx','sheet1','C2:C10')';%%æ¯?9ç§é£Ÿç‰©ç±»åˆ«çš„æœ?å¤§æ‘„å…¥é‡
%%f %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%   f  ç³»æ•°ä¸ºPä»·é’±ï¼Œæƒé‡?0.7
P1(1:45,1)=0;
for f_1=1:45
    P1(f_1,1)=w1*P(1,f_1)/S;
end
f1(1:44,1)=w2/22;
f=[P1;f1];

%%% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  E=Q*B æ¯ä¸ªè¥å…»æ‘„å…¥é‡?
E(1:23,1:89)=0;
for lv=1:45
    E(1,lv)=Q(1,lv)*B(lv,1);%%çƒ­é‡æ‘„å…¥
end
for q=2:23
    for i=1:45
    E(q,i)=(-1)*Q(1,i)*B(i,q);
    end
end

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% yueshu  æ¯ç§ç§ç±»æ‘„å…¥é‡èŒƒå›?
% yueshu(1:18,1:89)=0;
% yueshu(1,1:5)=1;yueshu(2,6:10)=1;yueshu(3,11:15)=1;yueshu(4,16:20)=1;yueshu(5,21:25)=1;yueshu(6,26:30)=1;
% yueshu(7,31:35)=1;yueshu(8,36:40)=1;yueshu(9,41:45)=1;yueshu(10,1:5)=-1;yueshu(11,6:10)=-1;yueshu(12,11:15)=-1;
% yueshu(13,16:20)=-1;yueshu(14,21:25)=-1;yueshu(15,26:30)=-1;yueshu(16,31:35)=-1;yueshu(17,36:40)=-1;yueshu(18,41:45)=-1;
yueshu(1:10,1:89)=0;
yueshu(1,1:5)=1;yueshu(2,11:15)=1;yueshu(3,16:20)=1;yueshu(4,21:25)=1;yueshu(5,41:45)=1;
yueshu(6,1:5)=-1;yueshu(7,11:15)=-1;yueshu(8,16:20)=-1;yueshu(9,21:25)=-1;yueshu(10,41:45)=-1;
%%A%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%   AAAAAAAAAAAAA
down(1,1:89)=0;%%åŸæ¥45ä¸ªé£Ÿç‰©åŠ ä¸?44ä¸ªè½¬å˜é‡å†åŠ ä¸?ä¸ªå¸¸ç†?
for do=1:45
    down(1,do)=(1)*P(1,do);
end
A=[E;yueshu;down];
% A=[E;down];
%%b%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%   bbbbbbbbbbbbb
b(1:34,1)=0;%%åŸæ¥ä¸?23+18ï¼Œå…ˆå†åŠ ä¸?,23+10+1
b(1,1)=2300;
% b(42,1)=(-1)*S;
b(34,1)=500/7;
for b1=2:23
    b(b1,1)=(-1)*0.97*N(1,b1);
end
b(24,1)=R(1,1);
b(25,1)=R(1,3);
b(26,1)=R(1,4);
b(27,1)=R(1,5);
b(28,1)=R(1,9);

b(29,1)=(-1)*L(1,1);
b(30,1)=(-1)*L(1,3);
b(31,1)=(-1)*L(1,4);
b(32,1)=(-1)*L(1,5);
b(33,1)=(-1)*L(1,9);
% for b2=24:32
%     b(b2,1)=R(1,b2-23);
% end
% for b3=33:41
%     b(b3,1)=(-1)*L(1,b3-32);
% end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  ç»å¯¹å€¼Aeq1 è¥å…»æ‘„å…¥é‡?
Aeq1(1:22,1:45)=0;
for j=1:20
    for n=1:45
        Aeq1(j,n)=Q(1,n)*B(n,j+1)/N(1,j+1);
    end
end
%%%%%%%%%%%%%%%%%%%%%  ç»å¯¹å€¼Aeq2  ä¸ºç»å¯¹å?¼æ‹†å¼?åçš„å€¼uï¼Œv
Aeq2(1:22,1:44)=0;
Aeq2(1,1)=-1;Aeq2(1,2)=1;
Aeq2(2,3)=-1;Aeq2(2,4)=1;
Aeq2(3,5)=-1;Aeq2(3,6)=1;
Aeq2(4,7)=-1;Aeq2(4,8)=1;
Aeq2(5,9)=-1;Aeq2(5,10)=1;
Aeq2(6,11)=-1;Aeq2(6,12)=1;
Aeq2(7,13)=-1;Aeq2(7,14)=1;
Aeq2(8,15)=-1;Aeq2(8,16)=1;
Aeq2(9,17)=-1;Aeq2(9,18)=1;
Aeq2(10,19)=-1;Aeq2(10,20)=1;
Aeq2(11,21)=-1;Aeq2(11,22)=1;
Aeq2(12,23)=-1;Aeq2(12,24)=1;
Aeq2(13,25)=-1;Aeq2(13,26)=1;
Aeq2(14,27)=-1;Aeq2(14,28)=1;
Aeq2(15,29)=-1;Aeq2(15,30)=1;
Aeq2(16,31)=-1;Aeq2(16,32)=1;
Aeq2(17,33)=-1;Aeq2(17,34)=1;
Aeq2(18,35)=-1;Aeq2(18,36)=1;
Aeq2(19,37)=-1;Aeq2(19,38)=1;
Aeq2(20,39)=-1;Aeq2(20,40)=1;
Aeq2(21,41)=-1;Aeq2(21,42)=1;
Aeq2(22,43)=-1;Aeq2(22,44)=1;
%%Aeq%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%   Aeq
Aeq=[Aeq1,Aeq2];

%%beq%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%   beq    ç­‰å·å³è¾¹ä¸?1
beq(1:22,1)=1;


%%lb%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  lb
lb(1:89,1)=0;%%xçš„æ‰€æœ‰å?¼å¤§äºç­‰äº?0ï¼Œä»xexcelä¸­å–


%%f%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%    å‡½æ•°
 [x,fval] =linprog(f,A,b,Aeq,beq,lb);
 
 sum=0;
 wrong=0;
 for xi=1:45
 result=x(xi,1)*P(1,xi);
 sum=sum+result;
 end
 for xwrong=46:89
     wrong=wrong+x(xwrong,1);
 end